(require 'key-chord)
(require 'evil)
(require 'evil-leader)
(require 'mode-line-color)
(require 'evil-mode-line)
;; (require 'evil-textobj-between)
(require 'surround)

(setq key-chord-two-keys-delay 0.3)
(global-evil-leader-mode)
(evil-leader/set-leader ",")

(define-key evil-insert-state-map "\C-e" 'end-of-line)
(key-chord-define global-map ",," 'evil-buffer)

;; main file, buffer nav bindings
(key-chord-define evil-normal-state-map ",t" 'projectile-find-file)
(key-chord-define evil-normal-state-map ",b" 'ido-switch-buffer)
(key-chord-define evil-normal-state-map ",r" 'prelude-recentf-ido-find-file)
(key-chord-define global-map "\\t" 'projectile-find-file)
(key-chord-define global-map "\\b" 'ido-switch-buffer)
(key-chord-define global-map "\\r" 'prelude-recentf-ido-find-file)
(key-chord-define global-map "\\G" 'magit-status)
(key-chord-define global-map "\\m" 'pr/find-model)
(key-chord-define global-map "\\c" 'pr/find-controller)
(key-chord-define global-map "\\v" 'pr/find-view)
(key-chord-define global-map "\\j" 'pr/find-js)
(key-chord-define global-map "\\t" 'pr/find-test)
(key-chord-define global-map "\\F" 'pr/find-factory)
(key-chord-define global-map "\\f" 'pr/find-feature)
(key-chord-define global-map "\\l" 'pr/find-lib)
(key-chord-define global-map "\\s" 'pr/find-style)
(key-chord-define global-map "\\G" 'pr/find-gemfile)
(key-chord-define global-map "\\S" 'pr/find-schema-file)
(key-chord-define global-map "\\R" 'pr/find-routes-file)


(define-key prelude-mode-map (kbd "C-c r") 'prelude-recentf-ido-find-file)
(define-key prelude-mode-map (kbd "C-c R") 'prelude-rename-file-and-buffer)
(define-key prelude-mode-map (kbd "C-c t") 'projectile-find-file)
(define-key prelude-mode-map (kbd "C-c T") 'eshell-other-window)
(define-key global-map (kbd "C-c b") 'ido-switch-buffer)

(define-key evil-normal-state-map (kbd "<tab>") 'indent-for-tab-command)
(define-key evil-normal-state-map (kbd "C-<tab>") 'hs-toggle-hiding)
(define-key evil-normal-state-map "\C-e" 'end-of-line)
(define-key evil-insert-state-map "\C-f" 'evil-forward-char)
(define-key evil-insert-state-map "\C-b" 'evil-backward-char)
(define-key evil-insert-state-map "\C-d" 'evil-delete-char)
(define-key evil-insert-state-map "\C-n" 'evil-next-line)
(define-key evil-insert-state-map "\C-p" 'evil-previous-line)
(define-key evil-insert-state-map "\C-w" 'evil-delete)
(define-key evil-insert-state-map "\C-y" 'yank)
(define-key evil-insert-state-map "\C-k" 'kill-line)
;; (define-key evil-normal-state-map (kbd "SPC") 'ace-jump-word-mode)
;; (define-key evil-normal-state-map (kbd "C-SPC") 'ace-jump-line-mode)

(define-key evil-motion-state-map (kbd "C-;") 'evil-repeat-find-char-reverse)

(key-chord-define evil-insert-state-map "jk" 'evil-normal-state)
;; (key-chord-define evil-normal-state-map "ss" 'save-buffer)
(key-chord-define evil-normal-state-map "ww" 'save-buffer)
(key-chord-define evil-normal-state-map "]q" 'next-error)
(key-chord-define evil-normal-state-map "[q" 'previous-error)
;; The use of 'c' here fucks everything up with evil, understandably
;; (key-chord-define evil-normal-state-map "]c" 'git-gutter:next-hunk)
;; (key-chord-define evil-normal-state-map "[c" 'git-gutter:previous-hunk)
(key-chord-define evil-normal-state-map "]f" 'pr/find-next-file)
(key-chord-define evil-normal-state-map "[f" 'pr/find-prev-file)
(evil-leader/set-key "gm" 'pr/find-model)
(evil-leader/set-key "gc" 'pr/find-controller)
(evil-leader/set-key "gv" 'pr/find-view)
(evil-leader/set-key "gj" 'pr/find-js)
(evil-leader/set-key "gt" 'pr/find-test)
(evil-leader/set-key "gF" 'pr/find-factory)
(evil-leader/set-key "gf" 'pr/find-feature)
(evil-leader/set-key "gl" 'pr/find-lib)
(evil-leader/set-key "gs" 'pr/find-style)
(evil-leader/set-key "gG" 'pr/find-gemfile)
(evil-leader/set-key "gS" 'pr/find-schema-file)
(evil-leader/set-key "gR" 'pr/find-routes-file)

(key-chord-mode 1)

(evil-leader/set-key "ga" 'pr/find-alternate-file-other-window)

(evil-leader/set-key "wh" 'evil-window-left)
(evil-leader/set-key "wl" 'evil-window-right)
(evil-leader/set-key "wj" 'evil-window-down)
(evil-leader/set-key "wk" 'evil-window-up)
(evil-leader/set-key "ws" 'evil-window-split)
(evil-leader/set-key "wv" 'evil-window-vsplit)

(key-chord-define evil-normal-state-map "HH" 'evil-window-left)
(key-chord-define evil-normal-state-map "LL" 'evil-window-right)
(key-chord-define evil-normal-state-map "KK" 'evil-window-up)
(key-chord-define evil-normal-state-map "JJ" 'evil-window-down)
(key-chord-define evil-normal-state-map "PP" 'evil-window-mru)

(define-key evil-insert-state-map (kbd "C-c C-k") 'yas-expand)

(define-key prelude-mode-map (kbd "C-c o") nil)


(global-set-key (kbd "C-c o") 'occur)

(global-set-key (kbd "C-,") 'er/expand-region)
(global-set-key (kbd "C-<") 'mc/mark-next-like-this)
(define-key global-map (kbd "A-/") 'hippie-expand)
(define-key global-map (kbd "C-c C-j") 'dired-jump)
(global-set-key (kbd "C-c C-r") 'mc/mark-sgml-tag-pair)
